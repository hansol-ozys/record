# 계약 디버깅

문제 해결은 어떠한 프로그래밍 언어에서도 중요한 기술이며, 이슈를 찾아내고 능률적으로 해결하도록 돕는다. 문제 해결은 기술과 과학의 양면성을 띤다. 개발 자들은 경험을 통해, 그리고 디버깅을 통해 장막 뒤에서 일어나는 일들을 탐구함으로써 문제 해결 기법을 배워야 한다. 이번 장에서는 솔리디티 계약에 관련된 코드를 디버깅하는 데 중점을 둔다.

### 디버깅

솔리디티 스마트 계약을 작성할 때 디버깅은 중요한 기술이다. 디버깅은 문제점 및 버그를 찾아내고, 코드를 변경함으로써 이를 해결한다. 적당한 도구와 유틸리티의 도움 없이 스마트 계약을 디버깅하기는 매우 어렵다. 일반적으로 디버깅은 각 행을 차례차례 실행하면서 임시, 지역, 전역 변수의 현재 상태를 파악하고, 계약을 실행하는 동안 각각의 인스트럭션을 따라간다.

디버깅 방법

1. 리믹스 편집기를 사용
2. 이벤트
3. 블록 탐색기


#### 리믹스 편집기

앞에서 솔리디티 계약을 작성할 때 리믹스 편집기를 사용했다. 그렇지만 리믹스에 있는 디버깅 유틸리티는 사용하지 않았다. 리믹스 디버거는 실행시간에 계약의 실행과 식별 이슈를 관찰하는 데 도움을 준다. 디버거에서 솔리디티 및 그로부터 생성된 계약 바이트코드가 실행된다. 디버거를 사용해 실행을 일시 정지해서 계약 코드, 상태 변수, 지역 변수, 스택 변수를 검사하고, 계약 코드가 생성한 EVM 인스트럭션을 들여다볼 수 있다.

``` solidity
pragma solidity ^0.4.0;

contract DebuggerSampleContract {
    int counter = 10;

    function LoopCounter(int _input) public view returns (int) {
        int returnValue;

        for (; _input < counter; _input++) {
            returnValue += _input;
        }
        return returnValue;
    }
}
```

debugger tab

- instructions : 함수 실행을 위한 바이트 코드
- Solidity Locals : 현재 컨텍스트와 관련된 지역 변수의 값과 자료형을 보여준다.
- Solidity State : 상태 변수의 값과 자료형을 보여준다.
- Step detail : 이것은 가스 사용량, 소비, 남은 가스를 디버그하는 데 중요하다.
- Call stack : 함수 코드에 필요한 임시 변수를 보여준다.
- Memory : 함수 내에서 사용되는 지역 변수를 보여준다.
- Call data : 클라이언트가 계약에 보내는 실제 데이터를 보여준다. 첫 4바이트는 함수 식별자를 가리키며, 나머지 32바이트는 들어오는 파라미터를 포함한다.


디버깅에서 중요한 측면은 필요에 따라 코드 행의 실행을 멈추는 것이다. 중단점이 이를 가능하게 한다. 행 번호가 있는 곳을 클릭하면 중단점이 설정되며, 다시 클릭하면 중단점이 제거된다. 함수를 실행하는 중에 중단점이 설정된 행에 도달하면 실행이 멈추며, Debugger 탭에서 값과 실행을 검토할 수 있다.