## 스마트 컨트랙트란 무엇인가

스마트 컨트랙트란 용어는 다양한 것들을 설명하기 위해 수년 동안 사용되어 왔다. 1990년대 암호학자 닉 사보는 이 용어를 "당사자들이 다른 약속에 따라 수행하는 프로토콜을 포함하여 디지털 형식으로 지정된 일련의 약속"이라고 정의했다. 그 이후로 스마트 컨트랙트의 개념은, 특히 2009년 비트코인의 발명으로 탈중앙화 블록체인 플랫폼이 도입된 후에 진화했다. 이더리움의 컨텍스트에서 이더리움 스마트 컨트랙트는 스마트하지도 않고 법적 컨트랙트도 아니기 때문에 다소 잘못된 이름임에도 이미 확고하게 자리를 잡았다. 이 책에서는 '스마트 컨트랙트'라는 용어를 불변적인 컴퓨터 프로그램을 지칭하는데, 이 프로그램은 이더리움 네트워크 프로토콜의 일부인 이더리움 가상 머신의 컨텍스트상에서 결정론적으로 작동한다. 이제 스마트 컨트랙트의 정의를 살펴보자.

- 컴퓨터 프로그램

    스마트 컨트랙트는 단순히 컴퓨터 프로그램이다. '컨트랙트'라는 단어는 이런 맥락에서 법적인 의미는 없다.

- 불변의

    스마트 컨트랙트 코드는 일단 배포되면, 변경할 수 없다. 기존 소프트웨어와 달리 스마트 컨트랙트를 수정하는 유일한 방법은 새로운 인스턴스를 배포하는 것이다.

- 결정론적

    스마트 컨트랙트를 실행한 결과물은 그것을 실행한 모든 이에게 동일한데, 실행을 시작한 트랜잭션의 컨텍스트와 실행 시점에 이더리움 블록체인의 상태가 동일하다는 전제가 있기 때문이다.

- EVM 컨텍스트

    스마트 컨트랙트는 매우 제한적인 실행 컨텍스트에서 작동된다. 이들은 자신의 상태, 호출한 트랜잭션의 컨텍스트 및 가장 최근 블록의 일부 정보에 접근할 수 있다.

- 탈중앙화된 월드 컴퓨터

    EVM은 모든 이더리움 노드에서 로컬 인스턴스로 실행되지만, EVM의 모든 인스턴스는 동일한 초기 상태에서 작동하고 동일한 최종 상태를 생성하기 때문에 시스템 전체가 단일 '월드 커뮤터'로 작동한다.

## 스마트 컨트랙트의 생명주기

스마트 컨트랙트는 일반적으로 솔리디티 같은 고급 언어로 작성된다. 그러나 컨트랙트를 실행하려면 EVM에서 실행되는 저수준의 바이트코드로 컴파일되어야 한다. 일단 컴파일되면 고유한 컨트랙트 생성 트랜잭션을 사용하여 이더리움 플랫폼에 배포되며, 이 트랜잭션은 고유한 컨트랙트 생성 주소, 즉 0x0으로 전송된다. 각 컨트랙트는 이더리움 주소로 식별되며, 이 주소는 원래 계정 및 논스의 함수로 컨트랙트 생성 트랜잭션에서 파생된다. 컨트랙트의 이더리움 주소는 트랜잭션에서 수신자로 사용되거나 컨트랙트에 자금을 보내거나 컨트랙트 함수를 호출하는 데 사용할 수 있다. EOA와 달리 새 스마트 컨트랙트를 위해 생성한 계정과 관련된 키는 없다. 컨트랙트 작성자는 프로토콜 수준에서 특별한 권한을 얻지 못한다.

컨트랙트는 수정할 수 없음. 따라서 selfdestruct 기능으로 삭제해야 함.

## 이더리움 고급 언어의 소개

스마트 컨트랙트를 바이트코드로 직접 프로그래밍할 수는 있지만, EVM 바이트코드는 다루기가 까다로워서 프로그래머가 읽고 이해하기가 매우 어렵다. 대신, 대부분의 이더리움 개발자는 프로그램을 작성하는 데 고급 언어를 사용하고 바이트코드로 변환하는 컴파일러를 사용한다.

모든 고급 언어가 스마트 컨트랙트를 작성하는 데 적합할 수 있지만, EVM 바이트코드에 컴파일할 수 있도록 임의의 언어를 적용하는 것은 일반적으로 상당히 번거롭고 혼란스럽다. 스마트 컨트랙트는 고도로 제한된 최소 실행 환경에서 작동한다. 또한 EVM 관련 세부 시스템 변수 및 기능 세트를 사용할 수 있어야 한다. 따라서 스마트 컨트랙트를 작성하는 데 적합한 범용 언어를 만드는 것보다 스마트 컨트랙트 언어를 처음부터 만드는 것이 더 쉽다. 그 결과로 스마트 컨트랙트를 프로그래밍하기 위해 많은 특수 용도의 언어가 등장했다. 이더리움에는 EVM 실행 가능 바이트코드를 생성하는데 필요한 컴파일러와 함께 여러 언어가 있다.

## 솔리디티로 스마트 컨트랙트 생성

언어의 속성이 매우 일반적이어서 다른 여러 블록체인 플랫폼에서 스마트 컨트랙트를 코딩하는 데 사용된다. 솔리디티 프로젝트의 주된 제품은 솔리디티 언어로 작성된 프로그램을 EVM 바이트 코드로 변환하는 솔리디티 컴파일러 solc이다. 이 프로젝트는 또한 이더리움 스마트 컨트랙트를 위한 중요한 애플리케이션 바이너리 인터페이스 표준을 관리한다. 이에 대해서는 이 장에서 자세히 설명한다. 솔리디티 컴파일러의 각 버전은 솔리디티 언어의 특정 버전에 해당하며, 해당 버전의 솔리디티 언어를 컴파일한다.

## 솔리디티 학습

이하 '솔리디티 프로그래밍 에센셜' 책에서 학습한 내용들 소개.